# auto_ssh_nopass_login

这是一个用于自动配置 SSH 免密登录的处理脚本。

## 操作步骤

1. 双击 `auto_ssh_nopass_login.bat` 脚本。
2. 按提示依次输入服务器的 Host（IP 地址）、用户名、密码。
3. 之后会有三次需要输入服务器密码的情况：
	- 第一次：用于验证当前是否可以免密登录，并在服务器上创建 `~/.ssh` 目录（如果没有的话）。
	- 第二次：使用 `scp` 命令将本地生成的公钥文件上传到服务器的 `/tmp` 目录。
	- 第三次：通过 `ssh` 登录，将 `/tmp/id_rsa.pub` 内容追加到服务器的 `~/.ssh/authorized_keys` 文件中，并设置权限。
4. 脚本会自动在本地 `~/.ssh/config` 文件中添加对应主机的免密登录配置。
5. 脚本执行完毕后，即可通过 SSH 免密登录该服务器。

## 功能描述

- 自动为每台服务器生成独立的 SSH 公钥和私钥，便于管理和维护。
- 自动检测和补全本地 SSH 配置文件，无需手动编辑。
- 支持参数输入或交互式输入服务器信息（IP、用户名、密码）。
- 一次配置后，绝大部分终端工具（如 Windows Terminal、Git Bash、Xshell 等）都可直接免密登录目标服务器。
- 密钥和配置文件按服务器分目录存放，方便查找和管理。

## 文件说明

- `auto_ssh_nopass_login.bat`：批处理脚本，用于自动化 SSH 免密登录配置。

## 使用方法

1. 双击运行 `auto_ssh_nopass_login.bat`，或在命令行中执行该文件。
2. 按照脚本中的提示输入服务器信息，或通过参数传递。
3. 脚本会自动完成密钥生成、配置文件更新等操作。

## 注意事项

- 请确保已正确配置 SSH 密钥和相关环境变量。
- 需要在 Windows 环境下运行。


## 实现原理

1. 用户通过参数或交互输入服务器 IP、用户名和密码。
2. 脚本自动检测本地 SSH 配置文件（`~/.ssh/config`）与待新增数据。
3. 根据检测结果决定生成SSH 密钥对（公钥和私钥），并按服务器 IP 分类存放，方便管理。
4. 私钥将保存在%USERPROFILE%\ssh_keygen\%SERVER_IP%下，并自动更新至%USERPROFILE%\.ssh\config中，公钥将自动追加道服务器的~/.ssh/authorized_keys中，确保免密登录生效。
5. 一次配置后，支持所有使用（`~/.ssh/config`）配置 SSH 的终端工具都可直接免密登录，无需重复输入密码。
